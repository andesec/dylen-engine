# DGS Service Configuration

# CORS
DGS_ALLOWED_ORIGINS=http://localhost:8003

# AI Provider Configuration (Gemini + OpenRouter)
# -----------------------------------------------

# Planner: High-reasoning model to design lesson sections
DGS_PLANNER_PROVIDER=openrouter
DGS_PLANNER_MODEL=openai/gpt-oss-120b:free

# Gatherer: Uses a powerful model to research the topic
DGS_GATHERER_PROVIDER=openrouter
DGS_GATHERER_MODEL=xiaomi/mimo-v2-flash:free

# Structurer: Uses a strict JSON-capable model to generate the lesson JSON
DGS_STRUCTURER_PROVIDER=openrouter
DGS_STRUCTURER_MODEL=openai/gpt-oss-20b:free

# Repair: Uses the lightweight model for quick JSON fixes
DGS_REPAIR_PROVIDER=openrouter
DGS_REPAIR_MODEL=google/gemma-3-27b-it:free

# Fenster: Uses a capable model to generate interactive widgets
DGS_FENSTER_PROVIDER=gemini
DGS_FENSTER_MODEL=gemini-2.0-flash-exp
# DGS_FENSTER_TECHNICAL_CONSTRAINTS={"max_tokens": 4000, "allowed_libs": ["alpine", "tailwind"]}

MERGE_GATHERER_STRUCTURER=true

# Optional: Override structurer based on request 'mode' (fast/balanced/best)
# DGS_STRUCTURER_MODEL_FAST=openai/gpt-oss-20b:free
# DGS_STRUCTURER_MODEL_BALANCED=openai/gpt-oss-20b:free
# DGS_STRUCTURER_MODEL_BEST=openai/gpt-oss-120b:free

# API Keys (REQUIRED)
GEMINI_API_KEY=your_gemini_api_key_here
TAVILY_API_KEY=your_tavily_api_key_here
# OpenRouter is used when DGS_*_PROVIDER=openrouter or when the request selects OpenRouter models.
OPENROUTER_API_KEY=your_openrouter_api_key_here
# Optional OpenRouter attribution headers.
# OPENROUTER_HTTP_REFERER=https://your-app.example
# OPENROUTER_TITLE=YourAppName

# Local testing: serve dummy model output from a file to avoid API calls.
DGS_USE_DUMMY_PLANNER_RESPONSE=false
DGS_DUMMY_PLANNER_RESPONSE_PATH=./fixtures/dummy_planner_response.md
DGS_USE_DUMMY_GATHERER_RESPONSE=false
DGS_DUMMY_GATHERER_RESPONSE_PATH=./fixtures/dummy_gatherer_response.md
DGS_USE_DUMMY_STRUCTURER_RESPONSE=false
DGS_DUMMY_STRUCTURER_RESPONSE_PATH=./fixtures/dummy_structurer_response.md
DGS_USE_DUMMY_REPAIRER_RESPONSE=false
DGS_DUMMY_REPAIRER_RESPONSE_PATH=./fixtures/dummy_repairer_response.md


# Postgres Audit (optional)
# DATABASE_URL is an alias/standard variable, often mapped to DGS_PG_DSN in deployment.
DATABASE_URL=postgresql://dgs:dgs_password@localhost:5432/dgs
DGS_PG_DSN=postgresql://dgs:dgs_password@localhost:5432/dgs
DGS_PG_CONNECT_TIMEOUT=5
DGS_LLM_AUDIT_ENABLED=false
#
# Postgres storage (lessons/jobs)
DGS_PG_LESSONS_TABLE=dgs_lessons
DGS_PG_JOBS_TABLE=dgs_jobs

# Schema & Prompts
DGS_SCHEMA_VERSION=1.0
DGS_PROMPT_VERSION=v1

# Optional Configuration
DGS_MAX_TOPIC_LENGTH=200
DGS_DEBUG=false
DGS_JOB_MAX_RETRIES=1
# DGS_JOBS_TTL_SECONDS=2592000
# DGS_JOBS_AUTO_PROCESS=false

# Logging configuration
# DGS_LOG_MAX_BYTES=5242880
# DGS_LOG_BACKUP_COUNT=10

DGS_CACHE_LESSON_CATALOG=false

# Firebase & Authentication
# -------------------------
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_SERVICE_ACCOUNT_JSON_PATH=/path/to/serviceAccountKey.json

# Notifications (Email via MailerSend API)
# ---------------------------------------
# Disabled by default; enable only when fully configured.
DGS_EMAIL_NOTIFICATIONS_ENABLED=false
DGS_EMAIL_PROVIDER=mailersend
DGS_EMAIL_FROM_ADDRESS=no-reply@example.com
DGS_EMAIL_FROM_NAME=DGS
DGS_MAILERSEND_API_KEY=your_mailersend_api_key_here
DGS_MAILERSEND_TIMEOUT_SECONDS=10
# Override only if you need a proxy or alternate endpoint.
DGS_MAILERSEND_BASE_URL=https://api.mailersend.com/v1
